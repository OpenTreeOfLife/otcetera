\documentclass[11pt]{article}
\input{preamble.tex}
\newcommand{\insed}{{\em incertae sedis}\xspace}
\newcommand{\specialHypergraph}{rooted tree-based hierarchically-hyper hypergraph \xspace}

\newcommand{\placedTaxa}{\ensuremath{\mathcal{P}}\xspace}
\newcommand{\placedTaxoTree}{\ensuremath{P}\xspace}
\newcommand{\placedTaxoTreeName}{placed-taxa tree\xspace}
\newcommand{\naiveFullTree}{\ensuremath{N}\xspace}
\newcommand{\naiveFullTreeName}{naive full taxonomic tree\xspace}
\usepackage{hyperref}
\hypersetup{backref,  linkcolor=blue, citecolor=black, colorlinks=true, hyperindex=true}
\begin{document}
The source for this in the doc subdirectory of the otcetera
    repo \url{https://github.com/mtholder/otcetera/tree/master/doc}.
This will probably be merged with the summarizing-taxonomy-plus-trees.tex document at
    some point.
\begin{center}
    {\bf Handling \insed taxa in Open Tree synthesis} \\
{Mark T.~Holder$^{1,2,\ast}$. feel free to contribute and add your name}
\end{center}
\tableofcontents
\section{Background}
See \href{https://github.com/OpenTreeOfLife/germinator/issues/32}{germinator issue \#32} for more details.

The phrase ``\insed'' is used in classifications to indicate that a group is of uncertain
    taxonomic placement.
The Open Tree's reference taxonomy is produced by a tool called smasher that notices hints that a taxon
    is \insed and labels that taxon with one of five flags.\footnote{see \url{https://github.com/OpenTreeOfLife/reference-taxonomy/wiki/Taxon-flags}. This document is not
    concerned with the flagging system {\em per se}, so ``\insed'' will be used here to
    refer to all of the flags that denote taxa with uncertain placement.}
While a taxonomist may intend to use \insed to indicate a limited number of possible positions for 
    a taxon to go in the taxonomy, we do not retain any such details.


Our current pipeline for producing a tree takes a set of ranked trees with the last tree
    being the taxonomy; thus it is a true supertree analysis.
The OTT is converted to a tree by pruning off taxa based on their flags.
As of December 2, 2015, this pruning (for all versions of the synthetic tree that we have used)
    has removed \insed taxa.

\subsection{Some examples in OTT}
The problem is becoming more acute because NCBI is putting a larger number of taxa into groups that
    are marked as ``unclassified.''
For example, when OTT 2.9 was created NCBI's clasification of the bird family Sylvidae included 
    a group five genera that were placed within ``\href{http://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Undef&id=36270&lvl=3&lin=f&keep=1&srchmode=1&unlock}{unclassified Sylviidae.}''
This includes the genus {Regulus}.
Thus in OTT 2.9 Regulus (ott ID = 3599326) is placed inside the family Silvidae (OTT ID = 259942).
The ``unclassified Sylviidae'' does not appear in OTT; instead Regulus is flagged as ``unclassified,sibling\_higher''
and all of the species within Regulus are flagged as ``unclassified\_inherited.''

The taxonomy (as of version 2.9) also contains 685 cases of taxa that are flagged as both
    ``unclassified\_inherited'' and  ``unclassified''\footnote{based on {\tt grep unclass.*unclassified\_inherited taxonomy.tsv}}

We would like to stop suppressing (pruning) \insed taxa, so that groups such as Regulus can appear
    appear in the synthetic tree.

\subsection{Challenge for the supertree construction}
Leaving \insed taxa in the taxonomy, means that the taxonomy can no longer be represented as 
    a tree.
Instead it must be represented by something equivalent to a special type of hypergraph (see below)
Thus, we need to devise a new pipeline for taking a set of trees and one low-ranked hypergraph and
    producing a hypergraph.

\section{\specialHypergraph}
Let each OTT Id in the taxonomy refer to a node.
If all nodes that correspond to \insed taxa or there descendants are removed,
    then the parent referenc in OTT Id allows one to construct 
    a directed graph - in particular the resulting graph will be rooted tree (it will be connected
    and have no cycles) that represents a set of phylogenetic hypotheses  which are compatible
    with the taxonomy.
Let us denote this \placedTaxoTree and refer to is as the ``\placedTaxoTreeName''.
The set of taxa (each of which maps to an OTT ID) in this tree will be referred to as \placedTaxa.

If we include all nodes from OTT (if we do not exclude \insed) we can still produce
    a tree,  \naiveFullTree, the ``\naiveFullTreeName''.
This is naive in the sense that the taxonomy does not really make the claim that an \insed
    taxon is excluded from its sister group (or the descendants of it sister group). 
Thus any resulution of \naiveFullTree can be said to be compatible with the taxonomy, but there
    exist other trees which conflict with \naiveFullTree but which do not conflict with
    the correct interpretation of the claims of taxonomy.
Note that \naiveFullTree tree induced by \placedTaxa is homeomorphic to \placedTaxoTree.

\bibliography{otcetera}
\end{document}
